#!/bin/bash

# __   _____  _   _ _   _ _____  __
# \ \ / / _ \| | | | \ | |_ _\ \/ /
#  \ V / | | | | | |  \| || | \  /
#   | || |_| | |_| | |\  || | /  \
#   |_| \___/ \___/|_| \_|___/_/\_\
#
# Lisence GPL3
# Homepage: https://github.com/apapamarkou/younix
# Author: Andrianos Papamarkou
# Email: papamarkoua@gmail.com

# Terminal abstraction script
# Usage: terminal [--columns=N] [--lines=N] [--title="Title"] [--] executable [args...]

COLS=80
LINES=24
TITLE=""
EXECUTABLE=""

# Parse arguments
while [[ $# -gt 0 ]]; do
    case $1 in
        --columns=*)
            COLS="${1#*=}"
            shift
            ;;
        --lines=*)
            LINES="${1#*=}"
            shift
            ;;
        --title=*)
            TITLE="${1#*=}"
            shift
            ;;
        --)
            shift
            break
            ;;
        *)
            EXECUTABLE="$1"
            shift
            break
            ;;
    esac
done

# Remaining args are for the executable
ARGS="$@"

# Determine terminal from $TERM or fallback
TER="${TERMINAL:-alacritty}"

case "$TER" in
    *alacritty*)
        exec alacritty ${TITLE:+--title="$TITLE"} -o window.dimensions.columns=$COLS -o window.dimensions.lines=$LINES ${EXECUTABLE:+-e $EXECUTABLE $ARGS}
        ;;
    *xfce4*)
        exec xfce4-terminal --hide-scrollbar --hide-menubar --geometry=${COLS}x${LINES} ${TITLE:+--title="$TITLE"} ${EXECUTABLE:+-x $EXECUTABLE $ARGS}
        ;;
    *foot*)
        exec foot ${TITLE:+--title="$TITLE"} --override=initial-window-size-chars=${COLS}x${LINES} ${EXECUTABLE:+-- $EXECUTABLE $ARGS}
        ;;
    *konsole*)
        exec konsole --hide-menubar --hide-tabbar ${TITLE:+--title="$TITLE"} --geometry ${COLS}x${LINES} ${EXECUTABLE:+-e $EXECUTABLE $ARGS}
        ;;
    *gnome-console*|*kgx*)
        exec kgx ${TITLE:+--title="$TITLE"} --geometry=${COLS}x${LINES} ${EXECUTABLE:+-- $EXECUTABLE $ARGS}
        ;;
    *gnome-terminal*)
        exec gnome-terminal --hide-menubar --geometry=${COLS}x${LINES} ${TITLE:+--title="$TITLE"} ${EXECUTABLE:+-- $EXECUTABLE $ARGS}
        ;;
    *xterm*)
        exec xterm ${TITLE:+-title "$TITLE"} -geometry ${COLS}x${LINES} ${EXECUTABLE:+-e $EXECUTABLE $ARGS}
        ;;
    *)
        # Fallback to alacritty
        exec alacritty ${TITLE:+--title="$TITLE"} -o window.dimensions.columns=$COLS -o window.dimensions.lines=$LINES ${EXECUTABLE:+-e $EXECUTABLE $ARGS}
        ;;
esac

