#!/bin/bash

# __   __    _   _ _   _ ___  __
# \ \ / /__ | | | | \ | (_) \/ /
#  \ V / _ \| | | |  \| | |\  / 
#   | | (_) | |_| | |\  | |/  \ 
#   |_|\___/ \___/|_| \_|_/_/\_\
#
# Lisence GPL3
# Homepage: https://github.com/apapamarkou/younix
# Author: Andrianos Papamarkou
# Email: papamarkoua@gmail.com

#
# A print method for youunix
#

SCRIPT_NAME=$(basename "$0")
TITLE="A print method"

showHelp() {
    echo "$DISTRO_NAME $TITLE"
    echo "Usage: $SCRIPT_NAME [OPTIONS] TEXT"
    echo "Options:"
    echo "  -c              Center text"
    echo "  -r              Right align text"
    echo "  --color=COLOR   Set text color"
    echo "  --figlet        Print text as figlet"
    echo "  -h              Show this help"
}

exitWithError() {
    echo "Error: $1" >&2
    exit 1
}

getColorCode() {
    case $1 in
        red) echo "1;31" ;;
        green) echo "1;32" ;;
        yellow) echo "1;33" ;;
        blue) echo "1;34" ;;
        magenta) echo "1;35" ;;
        cyan) echo "1;36" ;;
        white) echo "37" ;;
        *) exitWithError "Usage --color=<color>" ;;
        "") exitWithError "Usage --color=<color>" ;;
    esac
}

showFiglet() {
    local text="$1"
    local COLS=$(tput cols)

    while IFS= read -r line; do
        local original="$line"

        # Create colorized version
        if [ -n "$COLOR" ]; then
            local code=$(getColorCode "$COLOR")
            line=$'\e['"$code"'m'"$line"$'\e[0m'
        fi
        
        # Strip ANSI codes for measuring
        local plain=$(echo -e "$original" | sed 's/\x1b\[[0-9;]*m//g')
        local LEN=${#plain}

        if [ "$CENTER" = true ]; then
            local PADDING=$(( (COLS - LEN) / 2 ))
            (( PADDING < 0 )) && PADDING=0
            printf "%*s%s\n" "$PADDING" "" "$line"
        else
            printf "%b\n" "$line"
        fi
    done < <(figlet "$text")
}

CENTER=false
RIGHT=false
COLOR=""
TEXT=""
FIGLET=false

while [[ $# -gt 0 ]]; do
    case $1 in
        -c) CENTER=true; shift ;;
        -r) RIGHT=true; shift ;;
        --color=*) COLOR="${1#*=}"; shift ;;
        --figlet) FIGLET=true; shift ;;
        -h) showHelp; exit 0 ;;
        *) TEXT="$1"; shift ;;
    esac
done

[ -z "$TEXT" ] && { showHelp; exit 1; }

if [ "$FIGLET" = true ]; then
    showFiglet "$TEXT"
    exit 0
fi

ORIGINAL_TEXT="$TEXT"
if [ -n "$COLOR" ]; then
    COLOR_CODE=$(getColorCode "$COLOR")
    TEXT="\033[${COLOR_CODE}m${TEXT}\033[0m"
fi

if [ "$CENTER" = true ]; then
    COLS=$(tput cols)
    LEN=${#ORIGINAL_TEXT}
    PADDING=$(( (COLS - LEN) / 2 ))
    printf "%*s" $PADDING ""
    echo -e "$TEXT"
elif [ "$RIGHT" = true ]; then
    COLS=$(tput cols)
    LEN=${#ORIGINAL_TEXT}
    PADDING=$(( COLS - LEN ))
    printf "%*s" $PADDING ""
    echo -e "$TEXT"
else
    echo -e "$TEXT"
fi




